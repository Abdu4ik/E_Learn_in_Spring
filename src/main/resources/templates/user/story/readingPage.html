<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Reading page</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf_viewer.min.css" rel="stylesheet"
          type="text/css"/>
</head>
<body>
<div class="alert-warning" th:value="${complete}"></div>
<div class="container" style="text-align: center">
    <h2 th:text="${content.title}"></h2>
    <h2 th:text="${content.author}"></h2>
    <h2 th:text="${content.score}"></h2>
</div>

<div class="row" style="margin-left: fill">
    <div id="pdf_container" class="col-lg-7 bg-body-secondary col--dialog-scrollablesm-11 m-4"></div>
    <div class="col-lg-4 bg-body-secondary col-sm-11 mx-4">
        <h1>Translator</h1>
        <section>
            <div class="input  ">
                <label>
                    <span>English ðŸ‡¬ðŸ‡§</span>
                    <textarea id="input" placeholder=" " rows="9" class="form-control  col-md-12 fs-5"
                              oninput="myFunction()"></textarea>
                </label>
            </div>
            <div class="output">
                <label>
                    <span>UzbekðŸ‡ºðŸ‡¿</span>
                    <textarea rows="9" id="output" readonly="readonly"
                              class="form-control  col-md-12 fs-5">
                        </textarea>
                </label>
            </div>
            <br>
        </section>
    </div>

    <div th:if="${comments.size()!=0}">
        <h1>Comments</h1>
        <div th:each="comment : ${comments}">
            <div  class="col-md-5 offset-1" style="margin-left: 25px; background-color: #e9ecef; border-radius: 5px">
                <div style="margin-left: 30px" th:utext="${comment.comment}"> </div>
                <div>
                    <p th:text="${#temporals.format(comment.createdAt, 'HH:mm dd-MM-yyyy')}"></p>
                </div>
<!--                <div th:text="${comment.user?.username}"></div>-->
            </div>
            <br>
        </div>
    </div>
</div>













<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script type="text/javascript">


    function myFunction() {
        const x = document.getElementById("input").value;
        const url = "https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=uz&dt=t&q=" + x; //console.log(url);
        $.getJSON(url, function (data) {
            $('textarea#output').val(data[0][0][0]);
        });
    }


    var pdfjsLib = window['pdfjs-dist/build/pdf'];
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.worker.min.js';
    var pdfDoc = null;
    var scale = 2.5;
    if (IsMobile()) {
        scale = 1.7
    }
    var resolution = IsMobile() ? 1.5 : 1; //Set Resolution as per Desktop and Mobile.

    function LoadPdfFromUrl(url) {
        //Read PDF from URL.
        console.log(url)
        pdfjsLib.getDocument(url).promise.then(function (pdfDoc_) {
            pdfDoc = pdfDoc_;

            //Reference the Container DIV.
            var pdf_container = document.getElementById("pdf_container");
            pdf_container.style.display = "block";
            pdf_container.style.height = IsMobile() ? "1200px" : "820px";

            //Loop and render all pages.
            for (var i = 1; i <= pdfDoc.numPages; i++) {
                RenderPage(pdf_container, i);
            }
        });
    };

    function RenderPage(pdf_container, num) {
        pdfDoc.getPage(num).then(function (page) {
            //Create Canvas element and append to the Container DIV.
            var canvas = document.createElement('canvas');
            canvas.id = 'pdf-' + num;
            ctx = canvas.getContext('2d');
            pdf_container.appendChild(canvas);

            //Create and add empty DIV to add SPACE between pages.
            var spacer = document.createElement("div");
            spacer.style.height = "20px";
            pdf_container.appendChild(spacer);

            //Set the Canvas dimensions using ViewPort and Scale.
            var viewport = page.getViewport({scale: scale});
            canvas.height = resolution * viewport.height;
            canvas.width = resolution * viewport.width;

            //Render the PDF page.
            var renderContext = {
                canvasContext: ctx,
                viewport: viewport,
                transform: [resolution, 0, 0, resolution, 0, 0]
            };

            page.render(renderContext);
        });
    };

    function IsMobile() {
        var r = new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini");
        return r.test(navigator.userAgent);
    }


</script>
</body>
</html>